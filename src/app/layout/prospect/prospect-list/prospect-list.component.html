<div [@routerTransition]>
    <div class="search-box d-flex">
        <h5 class="mr-auto d-flex align-items-end">Danh sách tiềm năng</h5>
        <div class="input-group">
            <span class="input-group-addon">Tìm kiếm theo</span>
            <input type="text" class="form-control" placeholder="Tên, họ, sđt, email,.." (keyup)="searchTerm$.next($event.target.value)">
        </div>

        <div class="btn-group ml-2" ngbDropdown>
            <button type="button" class="btn btn-primary" ngbDropdownToggle data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Công cụ &nbsp;
            </button>
            <div class="dropdown-menu" ngbDropdownMenu>
                <a class="dropdown-item" (click)="multiDelete()">Xóa</a>
                <div class="dropdown-divider"></div>
                <!-- <a class="dropdown-item" (click)="sendFile()">Nhập file
                    <input type="file"/>
                </a> -->
                <div class="fileUpload dropdown-item">
                    <a>Nhập file</a>
                    <input type="file" class="upload" (change)="fileChange($event)" />
                </div>
                <a class="dropdown-item" (click)="exportFileExcel()">Xuất file</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" (click)="downTemplate()">Tải template</a>
            </div>
        </div>

        <button class="btn btn-primary ml-2" [routerLink]="['/prospect/create']">
            <i class="fa fa-plus" aria-hidden="true"></i>&nbsp; Thêm tiềm năng</button>
        <button class="btn btn-primary ml-2" (click)="refresh(true)">
            <i class="fa fa-refresh" aria-hidden="true"></i>
        </button>
    </div>
    <hr>
    <div class="filter-bar">
        <div class="form-inline">
            <div class="form-group">
                <label for="business" class="form-label">Đánh giá</label>
                <span class="custom-dropdown mx-sm-2">
                    <select class="form-control" [(ngModel)]="filterModel.rate">
                        <option [ngValue]="null">--Lựa chọn--</option>
                        <option *ngFor="let item of evaluationList | async" [value]="item.id">{{item.text}}</option>
                    </select>
                </span>
            </div>
            <div class="form-group ml-sm-2">
                <label for="business" class="form-label">Nguồn tiềm năng</label>
                <span class="custom-dropdown mx-sm-2">
                    <select class="form-control" [(ngModel)]="filterModel.prospectSource">
                        <option [ngValue]="null">--Lựa chọn--</option>
                        <option *ngFor="let item of prospectSourceList | async" [value]="item.id">{{item.text}}</option>
                        <option *ngFor="let item of prospectSourceList | async" [value]="item.id">{{item.text}}</option>
                    </select>
                </span>
            </div>
            <div class="form-group ml-sm-2">
                <label for="business" class="form-label">Lĩnh vực hoạt động</label>
                <span class="custom-dropdown mx-sm-2">
                    <select class="form-control" [(ngModel)]="filterModel.business">
                        <option [ngValue]="null">--Lựa chọn--</option>
                        <option *ngFor="let item of businessList | async" [value]="item.id">{{item.text}}</option>
                    </select>
                </span>
            </div>
            <button type="submit" class="btn btn-primary ml-sm-3" (click)="filter()">
                <i class="fa fa-filter" aria-hidden="true"></i>&nbsp; Lọc
            </button>

            <button class="btn btn-secondary ml-sm-3" (click)="clearFilter()">
                <i class="fa fa-times"></i>&nbsp; Xóa lọc
            </button>
        </div>
    </div>



    <div>
        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table-selection stripe row-border hover prospects-list-table">
            <thead>
                <tr [ngStyle]="{'width' : '30px'}">
                    <th class="text-center no-sort">
                        <label class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" [(ngModel)]="checkboxSeclectAll" (change)="onSelectAll($event.target.checked)">
                            <span class="custom-control-indicator"></span>

                        </label>


                    </th>
                    <th>D/xưng</th>
                    <th>Họ</th>
                    <th>Tên</th>
                    <th class="th-mark-status">Đánh giá</th>
                    <th>ĐT chính</th>
                    <th>ĐT di động</th>
                    <th>Địa chỉ email</th>
                    <th>Tên công ty</th>
                    <!-- <th>Nguồn tiềm năng</th>
                    <th>Lĩnh vực h/động</th> -->
                    <th>Phân công cho</th>
                    <th class="table-action">Thao tác</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of pagedResult.items">
                    <td class="text-center">
                        <label class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" [(ngModel)]="item.checkboxSelected" />
                            <span class="custom-control-indicator"></span>

                        </label>
                    </td>
                    <td>{{ item.salutation | translate }}</td>
                    <td>
                        <a [routerLink]="['../detail', item.id]" [title]="item.lastName">{{ item.lastName }}</a>
                    </td>
                    <td>
                        <a [routerLink]="['../detail', item.id]" [title]="item.firstName">{{ item.firstName}}</a>
                    </td>
                    <td class="td-mark-status">
                        <div [class.status-1]='item.evaluation=="Potential"' [class.status-2]='item.evaluation=="Nomal"' [class.status-3]='item.evaluation=="NonPotential"'>
                            {{ item.evaluation | translate}}
                        </div>
                    </td>
                    <td>
                        <span appPhoneNumberCallable>{{ item.companyPhone}}</span>
                    </td>
                    <td>
                        <span appPhoneNumberCallable>{{ item.mobilePhone }}</span>
                    </td>
                    <td>
                        <a [href]="'mailto:' + item.email" [title]="item.email">{{ item.email }}</a>
                    </td>
                    <td [title]="item.companyName ? item.companyName : ''">{{ item.companyName }}</td>
                    <!-- <td>{{ item.source | translate}}</td>
                    <td>{{ item.business| translate }} </td> -->
                    <td [title]="item.assignTo">{{ item.assignTo }}</td>
                    <td>
                        <div class="table-action">
                            <a [routerLink]="['../detail', item.id]">
                                <i class="fa fa-eye text-warning" aria-hidden="true"></i>
                            </a>
                            <a [routerLink]="['/prospect/edit', item.id]" class=" text-success ml-3">
                                <i class="fa fa-pencil" aria-hidden="true"> </i>
                            </a>
                            <a class="text-info ml-3" [href]="'mailto:' + item.email">
                                <i class="fa fa-envelope-o " aria-hidden="true"></i>
                            </a>
                            <a (click)="delete(item.id)" class=" text-dark ml-3">
                                <i class="fa fa-trash-o" aria-hidden="true"></i>
                            </a>
                        </div>

                    </td>
                </tr>
            </tbody>
        </table>
        <app-pagination [pagedResult]="pagedResult" (pagedResultChange)="pagedResultChange($event)"></app-pagination>
    </div>


</div>
<ngx-spinner bdColor="rgba(51, 51, 51, 0.7)" size="medium" color="#fff" type="ball-clip-rotate-multiple"></ngx-spinner>
