<div class="p-3">
    <h5 class="text-uppercase font__heading--size">
        báo cáo khảo sát công trường (site surveying report)
    </h5>
    <div class="mt-3" *ngIf="!documentData">
        <div class="text-center">
            <img class="image-empty" src="assets/images/file_empty.png">
            <div class="mt-3">Hiện chưa có bản báo cáo khảo sát công trường nào</div>
            <div class="mt-3 d-flex justify-content-center">
                <button class="btn btn-primary" [routerLink]="['./create']" (click)="onActivate(false)">
                    Tạo mới báo cáo khảo sát công trường
                </button>
            </div>
        </div>
    </div>

    <div class="mt-4" *ngIf="documentData">
        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table-selection stripe row-border hover cell-border dataTable">
            <thead>
                <tr>

                    <th>Tên tài liệu</th>
                    <th>Lần phỏng vấn</th>
                    <th>Tình trạng</th>
                    <th>Người tạo</th>
                    <th>Ngày tạo</th>
                    <th class="text-center">Thao tác</th>
                </tr>
            </thead>
            <tbody>
                <tr>

                    <td [title]="documentData.tenTaiLieu">
                        <a class="link-effect" [routerLink]="['./info']">{{ documentData.tenTaiLieu }}</a>
                    </td>
                    <td>{{ documentData.lanPhongVan }}</td>
                    <td [title]="(documentData.isDraft) ? 'Bản nháp' : 'Chính thức'">
                        {{ (documentData.isDraft) ? 'Bản nháp' : 'Chính thức' }}
                    </td>
                    <td [title]="documentData.nguoiTao?.name">
                        {{ documentData.nguoiTao?.name }}
                    </td>
                    <td [title]="(documentData.ngayTao)*1000 | date:'dd/MM/yyyy'">
                        {{ (documentData.ngayTao)*1000 | date:'dd/MM/yyyy' }}
                    </td>
                    <td>
                        <div class="d-flex justify-content-center">
                            <div>
                                <a title="Xem file" (click)="onActivate(true)" [routerLink]="['./info']">
                                    <i class="fa fa-eye text-warning" aria-hidden="true"></i>
                                </a>
                                <a title="Edit file" class=" text-success ml-3" (click)="onActivate(false)"
                                    [routerLink]="['./edit']">
                                    <i class="fa fa-pencil cursor-pointer" aria-hidden="true"> </i>
                                </a>
                                <a class=" text-dark ml-3" (click)="deleteDoc()">
                                    <i class="fa fa-trash-o" aria-hidden="true"></i>
                                </a>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<ngx-spinner bdColor="rgba(51, 51, 51, 0.7)" size="medium" color="#fff" type="ball-clip-rotate-multiple"></ngx-spinner>

<div class="mt-5 p-3" *ngIf="isHistory">
    <div class="d-flex justify-content-between">
        <h5 class="text-uppercase mb-3">Lịch sử cập nhật</h5>
    </div>

    <div class="table-responsive">
        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger2" class="table-selection stripe row-border hover cell-border dataTable">
            <thead>
                <tr>
                    <th class="w-10">Lần cập nhật</th>
                    <th class="w-10">Người cập nhật</th>
                    <th class="w-15">Ngày cập nhật</th>
                    <th class="w-25">Nội dung cập nhật</th>
                    <th class="w-40">Chi tiết cập nhật</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let updateInfo of updateInfoList; index as i">
                    <td class="text-center">
                        {{ (updateInfoList.length - i) }}
                    </td>
                    <td class="text-center">{{ updateInfo.employee?.employeeName }}</td>
                    <td class="text-center">{{ (updateInfo.changedTime)*1000 | date:'dd/MM/yyyy' }}</td>
                    <td class="text-center">
                        <p *ngIf="isData">Cập nhật tài liệu</p>
                        <p *ngIf="!isData">Xóa tài liệu</p>
                        <p *ngFor="let item of updateInfo.liveFormChangeds; index as j">
                            {{ item.liveFormTitle }}: {{ item.oldValue }} --- {{ item.newValue }}
                        </p>
                    </td>
                    <td class="text-center">
                        {{ (updateInfo?.updateDesc != 'undefined') ? updateInfo.updateDesc : '' }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <app-pagination [(pagedResult)]="pagedResult" (pagedResultChange)="pagedResultChange($event)"></app-pagination>
</div>
