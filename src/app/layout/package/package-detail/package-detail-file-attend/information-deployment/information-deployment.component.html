<!-- [@routerTransition] -->
<div *ngIf="!loading">

    <div class=" title-list-package d-flex flex-wrap align-items-center status-filter" style=" padding:0px 20px 20px 30px;">

        <div class="mr-auto d-flex align-items-end list-package mt-2 mb-2">
            <div class="d-flex justify-content-start" style="height: 40px;">
                <div class="rule mr-2">
                </div>
                <div class="center-parent mr-4" style="font-size: 18px">
                    <div *ngIf="packageInfo?.stageStatus.id == bidStatus.ChuaThongBaoTrienKhai || packageInfo?.stageStatus.id == bidStatus.ThamGiaDuThau">Chưa
                        thông báo triển khai</div>
                    <div *ngIf="packageInfo?.stageStatus.id == bidStatus.DaThongBaoTrienKhai">Đã thông báo triển khai</div>
                    <div *ngIf="packageInfo?.stageStatus.id == bidStatus.DaXacNhanPhanCong">Đã xác nhận phân công</div>
                    <div *ngIf="(packageInfo?.stageStatus.id !== bidStatus.ChuaThongBaoTrienKhai) && (packageInfo?.stageStatus.id !== bidStatus.ThamGiaDuThau)
                    && (packageInfo?.stageStatus.id !== bidStatus.DaThongBaoTrienKhai) && (packageInfo?.stageStatus.id !== bidStatus.DaXacNhanPhanCong)">Đã
                        gửi phân công tiến độ</div>
                </div>
            </div>
        </div>
        <div>
            <div class="btn-toolbar mt-2 mb-2">
                <ng-container *ngIf="BatDauLapHSDT">
                    <button type="button" *ngIf="packageInfo?.stageStatus.id === bidStatus.DaGuiPhanCongTienDo" class="btn btn-primary mr-1"
                        (click)="startSetHSDT()">Bắt đầu lập HSDT</button>
                </ng-container>

                <ng-container *ngIf="GuiPCTD">
                    <button type="button" *ngIf="isconfirmProgress" [ngClass]="{'btn-dep':isconfirmProgress == true}"
                        class="btn btn-up" (click)="openModeSendAssignment(SendAssignment)">{{textConfirmProgress}}</button>
                </ng-container>

                <ng-container *ngIf="ThongBaoTrienKhai || (currentUserInfo?.department?.text === 'PHÒNG DỰ THẦU' && currentUserInfo?.level?.text === 'Trưởng phòng')">
                    <button type="button" *ngIf="packageInfo?.stageStatus.id == bidStatus.ChuaThongBaoTrienKhai || packageInfo?.stageStatus.id == bidStatus.ThamGiaDuThau"
                        class="btn btn-up btn-dep" (click)="openModalDeployment(informationDeployment)">Thông báo triển
                        khai
                    </button>
                </ng-container>
                <ng-container *ngIf="TaiTemplatePCTD">
                    <button type="button" *ngIf="packageInfo?.stageStatus.id !== bidStatus.ChuaThongBaoTrienKhai && packageInfo?.stageStatus.id !== bidStatus.ThamGiaDuThau"
                        class="btn btn-primary mr-1" (click)="downloadTemplate()">Tải Template
                    </button>
                </ng-container>
                <ng-container *ngIf="GuiPCTD">
                    <button class="btn btn-primary mr-1" *ngIf="packageInfo?.stageStatus.id == bidStatus.DaXacNhanPhanCong"
                        (click)="sendTenderPlan()">Gửi phân công tiến độ</button>

                </ng-container>
                <ng-container *ngIf="TaoMoiBangPCTD">
                    <button *ngIf="tenderPlan?.isDraftVersion" class="btn btn-primary mr-1" (click)="confirmTenderPlan()">Xác
                        nhận phân công tiến độ</button>

                </ng-container>

                <button type="button" class="btn btn-primary " (click)="refresh()">
                    <i class="fa fa-refresh" aria-hidden="true"></i>
                </button>
            </div>
        </div>
    </div>

    <div *ngIf="!loading">
        <div class="ml-3" *ngIf="tenderPlan">
            <h5 class="text-uppercase mb-3">bảng phân công tiến độ (tender preparation planning assignment)</h5>
            <table class="table-layout--fixed w-100">
                <thead>
                    <tr>
                        <th class="with-file-name">Tên tài liệu</th>
                        <th class="w-20">Người duyệt</th>
                        <th class="w-20">Người tạo</th>
                        <th class="w-20">Ngày tạo</th>
                        <th class="text-center w-tab">Thao tác</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-truncate">
                            <ng-container *ngIf="XemBangPCTD">
                                <a [routerLink]="['./view']" (click)="changeAction('view')">{{tenderPlan.projectInformation}}</a>
                            </ng-container>
                            <ng-container *ngIf="!XemBangPCTD">
                                {{tenderPlan.projectInformation}}
                            </ng-container>
                        </td>
                        <td class="text-truncate">{{tenderPlan.approvedEmployee?.employeeName ?
                            tenderPlan.approvedEmployee?.employeeName : 'Chưa duyệt'}}
                        </td>
                        <td class="text-truncate">{{tenderPlan.createdEmployee?.employeeName}}</td>
                        <td class="text-truncate">{{tenderPlan.createDate * 1000 | date: 'dd/MM/yyyy HH:mm':'+0000'}}</td>
                        <td>
                            <div class="d-flex justify-content-center">
                                <div>
                                    <ng-container *ngIf="XemBangPCTD">
                                        <a [routerLink]="['./view']" (click)="changeAction('view')">
                                            <i class="fa fa-eye text-warning" aria-hidden="true"></i>
                                        </a>
                                    </ng-container>
                                    <ng-container *ngIf="SuaBangPCTD">
                                        <ng-container *ngIf="isShowActionStage">
                                            <a class=" text-success ml-3" [routerLink]="packageInfo?.stageStatus.id == bidStatus.DaGuiPhanCongTienDo ? [] : ['./edit']"
                                                (click)="changeAction('edit')">
                                                <i class="fa fa-pencil cursor-pointer" aria-hidden="true"> </i>
                                            </a>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container *ngIf="XoaBangPCTD">
                                        <ng-container *ngIf="isShowActionStage">
                                            <a class=" text-dark ml-3" (click)="packageInfo?.stageStatus.id == bidStatus.DaGuiPhanCongTienDo ? null : deleteTenderPlan()">
                                                <i class="fa fa-trash-o cursor-pointer" aria-hidden="true"></i>
                                            </a>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container *ngIf="InBangPCTD">
                                        <a class="ml-3" (click)="print()">
                                            <i class="fa fa-print icon-print cursor-pointer" aria-hidden="true"></i>
                                        </a>
                                    </ng-container>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="mt-5" *ngIf="!tenderPlan">
            <div class="text-center">
                <img class="icon-filter" src="assets/images/ic-file0.png" alt="">
            </div>
            <div class="text-center mt-3">
                {{toggleTextUpFile}}
            </div>
            <div class="text-center mt-3" *ngIf="packageInfo?.stageStatus.id == bidStatus.DaThongBaoTrienKhai && !tenderPlan">
                <button class="btn btn-primary ml-1" routerLink="./create" (click)="changeAction('create')">
                    Tạo mới bảng phân công tiến độ
                </button>
            </div>
        </div>


    </div>


    <div class="mt-5 ml-3" *ngIf="historyList && historyList.length > 0">
        <div class="d-flex justify-content-between">
            <h5 class="text-uppercase mb-3">Lịch sử cập nhật</h5>
        </div>

        <table class="table-layout--fixed w-100">
            <thead>
                <tr>
                    <th class="w-10">Lần cập nhật</th>
                    <th class="w-15">Người cập nhật</th>
                    <th class="w-15">Ngày cập nhật</th>
                    <th class="w-20">Nội dung cập nhật</th>
                    <th class="w-40">Chi tiết cập nhật</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let itemByChangedTimes of historyList; let i = index">
                    <td class="text-center">
                        {{indexItemHistoryChange - i}}
                    </td>
                    <td> {{itemByChangedTimes.items[0].employee?.employeeName}}</td>
                    <td>{{ (itemByChangedTimes.items[0].changedTime)*1000 | date:'dd/MM/yyyy , HH:mm':'+0000' }}</td>
                    <td>
                        <div [title]="itemByChangedTimes.items[0].updateDesc">{{itemByChangedTimes.items[0].updateDesc}}</div>
                    </td>
                    <td>
                        <ng-container *ngFor="let changedTime of itemByChangedTimes.items; index as index">
                            <div *ngIf="index < 4">
                                <div *ngIf="changedTime.liveFormChangeds && changedTime.liveFormChangeds.length !== 0">
                                    <div *ngFor="let liveFormSubject of changedTime.liveFormChangeds">
                                        <ng-container *ngFor="let liveFormBySubjectItem of liveFormSubject.items; index as count">
                                            <div *ngIf="count < lineDisplay(liveFormSubject.items.length, itemByChangedTimes.items.length)">
                                                <span *ngIf="liveFormBySubjectItem.liveFormSubject === 'SignedByApprovalPerson'">
                                                    <strong>Người duyệt</strong>
                                                    <span>:</span>
                                                    <strong>Chưa ký
                                                    </strong> thành
                                                    <strong>Đã ký
                                                    </strong>
                                                </span>
                                                <span *ngIf="liveFormBySubjectItem.liveFormSubject === 'KeyPersonnel'">
                                                    <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'SignedByPreparedPerson'">
                                                        <strong>Người tạo</strong>
                                                        <span>:</span>
                                                        <strong>{{liveFormBySubjectItem.oldValue ? 'Đã ký' : 'Chưa
                                                            ký'}}
                                                        </strong> thành
                                                        <strong>{{liveFormBySubjectItem.newValue ? 'Đã ký' : 'Chưa
                                                            ký'}}
                                                        </strong>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'ProjectDirectorEmployeeName' || liveFormBySubjectItem.liveFormTitle === 'TenderDepartmentEmployeeName'
                                                        || liveFormBySubjectItem.liveFormTitle === 'TechnicalDepartmentEmployeeName' || liveFormBySubjectItem.liveFormTitle === 'BIMDepartmentEmployeeName'">
                                                        <strong>KEY PERSONNEL</strong>
                                                        <span>:</span>
                                                        <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'ProjectDirectorEmployeeName'">
                                                            Project Director: từ
                                                            <strong>{{liveFormBySubjectItem.oldValue ?
                                                                liveFormBySubjectItem.oldValue : 'không
                                                                có'}}
                                                            </strong> thành
                                                            <strong>{{liveFormBySubjectItem.newValue ?
                                                                liveFormBySubjectItem.newValue : 'không
                                                                có'}}
                                                            </strong>
                                                        </div>
                                                        <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'TenderDepartmentEmployeeName'">
                                                            Tender Dept: từ
                                                            <strong>{{liveFormBySubjectItem.oldValue ?
                                                                liveFormBySubjectItem.oldValue : 'không
                                                                có'}}
                                                            </strong> thành
                                                            <strong>{{liveFormBySubjectItem.newValue ?
                                                                liveFormBySubjectItem.newValue : 'không
                                                                có'}}
                                                            </strong>
                                                        </div>
                                                        <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'TechnicalDepartmentEmployeeName'">
                                                            Technical Dept: từ
                                                            <strong>{{liveFormBySubjectItem.oldValue ?
                                                                liveFormBySubjectItem.oldValue : 'không
                                                                có'}}
                                                            </strong> thành
                                                            <strong>{{liveFormBySubjectItem.newValue ?
                                                                liveFormBySubjectItem.newValue : 'không
                                                                có'}}
                                                            </strong>
                                                        </div>
                                                        <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'BIMDepartmentEmployeeName'">
                                                            BIM Dept: từ
                                                            <strong>{{liveFormBySubjectItem.oldValue ?
                                                                liveFormBySubjectItem.oldValue : 'không
                                                                có'}}
                                                            </strong> thành
                                                            <strong>{{liveFormBySubjectItem.newValue ?
                                                                liveFormBySubjectItem.newValue : 'không
                                                                có'}}
                                                            </strong>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.liveFormTitle === 'QueryDeadline'">
                                                        Query's Deadline: từ
                                                        <strong>{{liveFormBySubjectItem.oldValue ?
                                                            liveFormBySubjectItem.oldValue : 'không
                                                            có'}}
                                                        </strong> thành
                                                        <strong>{{liveFormBySubjectItem.newValue ?
                                                            liveFormBySubjectItem.newValue : 'không
                                                            có'}}
                                                        </strong>
                                                    </div>
                                                </span>
                                                <span *ngIf="!liveFormBySubjectItem.liveFormSubject">
                                                    Tên tài liệu: từ
                                                    <strong>{{liveFormBySubjectItem.oldValue ?
                                                        liveFormBySubjectItem.oldValue :
                                                        'không có'}}</strong>
                                                    thành
                                                    <strong>{{liveFormBySubjectItem.newValue ?
                                                        liveFormBySubjectItem.newValue :
                                                        'không có'}}</strong>
                                                </span>
                                                <span *ngIf="liveFormBySubjectItem.liveFormSubject === 'AssigmentTask'">
                                                    <strong>{{scheduleAssignments[liveFormBySubjectItem.oldValue.ItemId].idConfig}}.
                                                        {{liveFormBySubjectItem.oldValue.ItemName}}
                                                    </strong>:
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.ItemDesc !== liveFormBySubjectItem.newValue.ItemDesc">
                                                        Công việc: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.ItemDesc ?
                                                                liveFormBySubjectItem.oldValue.ItemDesc
                                                                : 'không có'}}</strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.ItemDesc ?
                                                                liveFormBySubjectItem.newValue.ItemDesc
                                                                : 'không có'}}</strong>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.WhoIsInChargeName !== liveFormBySubjectItem.newValue.WhoIsInChargeName">
                                                        Mô tả: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.WhoIsInChargeName
                                                                ?
                                                                liveFormBySubjectItem.oldValue.WhoIsInChargeName
                                                                : 'không có'}}</strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.WhoIsInChargeName
                                                                ?
                                                                liveFormBySubjectItem.newValue.WhoIsInChargeName
                                                                : 'không có'}}</strong>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.IsFinish !== liveFormBySubjectItem.newValue.IsFinish">
                                                        Phân công cho: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.IsFinish ? 'Hoàn
                                                                thành' :
                                                                'Chưa hoàn
                                                                thành'}}
                                                            </strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.IsFinish ? 'Hoàn
                                                                thành' :
                                                                'Chưa hoàn
                                                                thành'}}
                                                            </strong>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.IsFinish !== liveFormBySubjectItem.newValue.IsFinish">
                                                        Hoàn thành: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.IsFinish ? 'Hoàn
                                                                thành' :
                                                                'Chưa hoàn
                                                                thành'}}
                                                            </strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.IsFinish ? 'Hoàn
                                                                thành' :
                                                                'Chưa hoàn
                                                                thành'}}
                                                            </strong>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.StartDate !== liveFormBySubjectItem.newValue.StartDate">
                                                        Ngày bắt đầu: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.StartDate ?
                                                                (liveFormBySubjectItem.oldValue.StartDate*1000
                                                                | date: 'dd/MM/yyyy' : '+0000' ) : 'không có'}}</strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.StartDate ?
                                                                (liveFormBySubjectItem.newValue.StartDate*1000
                                                                | date: 'dd/MM/yyyy' : '+0000') : 'không có'}}</strong>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.FinishDate !== liveFormBySubjectItem.newValue.FinishDate">
                                                        Ngày bắt đầu: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.FinishDate ?
                                                                (liveFormBySubjectItem.oldValue.FinishDate*1000
                                                                | date: 'dd/MM/yyyy' : '+0000' ) : 'không có'}}</strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.FinishDate ?
                                                                (liveFormBySubjectItem.newValue.FinishDate*1000
                                                                | date: 'dd/MM/yyyy' : '+0000') : 'không có'}}</strong>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="liveFormBySubjectItem.oldValue.Duration !== liveFormBySubjectItem.newValue.Duration">
                                                        Tổng thời gian: từ
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.oldValue.Duration ?
                                                                liveFormBySubjectItem.oldValue.Duration
                                                                : 'không có'}}</strong>
                                                        </span>
                                                        thành
                                                        <span>
                                                            <strong>{{liveFormBySubjectItem.newValue.Duration ?
                                                                liveFormBySubjectItem.newValue.Duration
                                                                : 'không có'}}</strong>
                                                        </span>
                                                    </div>
                                                </span>
                                            </div>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                        <div *ngIf="brief(itemByChangedTimes.items)" class="d-flex justify-content-center py-1">
                            <a class="popup-detail" (click)="viewDetail(itemByChangedTimes, indexItemHistoryChange - i)">Xem thêm</a>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <app-pagination [(pagedResult)]="pagedResultChangeHistoryList" (pagedResultChange)="pagedResultChangeHistory($event)"></app-pagination>
    </div>

    <!-- <app-assignment-progress *ngIf="showTabelAssignment && isShowTable" [dataConfirm]="dataConfirm" [hideButon]="hideButon"
    [UploadItem]="uploadItem"></app-assignment-progress>
<app-assignment-progress *ngIf="!isShowTable" [hideButon]="hideButon"></app-assignment-progress> -->

    <!-- Model Gửi thông báo -->
    <ng-template #informationDeployment>
        <div class="modal-header no-boder-bottom">
            <div class="pull-left ">
                <div class="text-title icon-arrow">
                    <img width="15" height="15" class="img-back pointer" src="assets\images\nghia.png" (click)="ClosePopup()" />
                    <h4 class="modal-title text-dark d-inline text-send-noti"> Gửi thư thông báo triển khai</h4>
                </div>
            </div>

            <div class="pull-right">
                <button type="button" class="btn btn-cancel mr-1" aria-label="Close" (click)="modalRef.hide()">Hủy</button>
                <button type="button" *ngIf="!showBtnNotification" class="btn btn-send" aria-label="Close" (click)="SendInformation()">Gửi</button>
            </div>
        </div>
        <div class="modal-body">
            <div class="input-group mb-3">
                <span class="input-group-addon">To:</span>
                <ng-select class="w-100" [items]="listEmailSearchTo" typeToSearchText="Nhập email" addTagText="Thêm email:"
                    clearAllText="Xóa tất cả" [addTag]="true" (change)="validateEmailTo($event)" [hideSelected]="true"
                    multiple="true" bindLabel="employeeName" [searchFn]="customSearchFn" [(ngModel)]="emailModel.to">
                    <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
                        <table class="table-email--box-shadow">
                            <tr>{{item.employeeName}}</tr>
                            <tr>{{item.employeeEmail}}</tr>
                        </table>
                    </ng-template>
                </ng-select>
            </div>

            <div class="input-group mb-3" *ngIf="isSendCc">
                <span class="input-group-addon" id="basic-addon1">Cc:</span>
                <ng-select class="w-100" [items]="listEmailSearchCc" addTagText="Thêm email:" clearAllText="Xóa tất cả"
                    [addTag]="true" [hideSelected]="true" multiple="true" bindLabel="employeeName" (change)="validateEmailCc($event)"
                    [searchFn]="customSearchFn" [(ngModel)]="emailModel.cc">
                    <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
                        <table class="table-email--box-shadow">
                            <tr>{{item.employeeName}}</tr>
                            <tr>{{item.employeeEmail}}</tr>
                        </table>
                    </ng-template>
                </ng-select>
            </div>

            <div class="input-group mb-3" *ngIf="isSendBcc">
                <span class="input-group-addon" id="basic-addon1">Bcc:</span>
                <ng-select class="w-100" [items]="listEmailSearchBcc" addTagText="Thêm email:" clearAllText="Xóa tất cả"
                    [addTag]="true" [hideSelected]="true" (change)="validateEmailBcc($event)" multiple="true" bindLabel="employeeName"
                    [searchFn]="customSearchFn" [(ngModel)]="emailModel.bcc">
                    <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
                        <table class="table-email--box-shadow">
                            <tr>{{item.employeeName}}</tr>
                            <tr>{{item.employeeEmail}}</tr>
                        </table>
                    </ng-template>
                </ng-select>
            </div>

            <div class="mb-3 ml-1" *ngIf="!isSendCc || !isSendBcc">
                <span class="">
                    <span *ngIf="!isSendCc" title="Thêm người nhận Cc" class="send-cc" (click)="sendCc()">Thêm Cc</span>
                    <span *ngIf="!isSendCc && !isSendBcc" class="send-cc"> | </span>
                    <span *ngIf="!isSendBcc" title="Thêm người nhận Bcc" class="send-cc" (click)="sendBcc()">Thêm Bcc</span>
                </span>
            </div>

            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon1">Tiêu đề:</span>
                </div>
                <input type="text" [(ngModel)]="emailModel.subject" class="form-control boder-left-none" placeholder=""
                    aria-label="Tiede" aria-describedby="basic-addon1">
            </div>
            <div class="body-ckeditor">
                <ckeditor [(ngModel)]="emailModel.content" [config]="ckeConfig" #ckeditor debounce="500" (change)="onChange($event)"
                    (paste)="onPaste($event)">
                    <ckbutton [name]="'saveButton'" [command]="'saveCmd'" [icon]="'save.png'" [label]="'Save Document'"
                        [toolbar]="'clipboard,1'">
                    </ckbutton>
                </ckeditor>
            </div>
            <!-- <div *ngFor="let item of file; let i = index" class="d-flex justify-content-start pt-2">
            <div class="center-parent">
                <span class="text-truncate">{{item?.name}}</span>
            </div>
            <div class="pl-2">
                <button (click)="deleteFileUpload(i)" class="btn btn-secondary">X</button>
            </div>
        </div> -->
            <div class="d-flex">
                <div class="fileUpload width-but-upload pt-2">
                    <button class="btn btn-primary">
                        <i class="fa fa-paperclip" aria-hidden="true"></i>&nbsp;&nbsp; Đính kèm file</button>
                    <input type="file" class="upload" tabindex="2" (change)="uploadfile($event)" multiple />
                </div>
                <div class="width-add-file-upload">
                    <div *ngFor="let item of file; let i = index" class="d-flex pl-2 pt-2 float-left">
                        <div class="center-parent">
                            <span class="text-truncate">{{item?.name}}</span>
                        </div>
                        <div class="pl-2 center-parent">
                            <button (click)="deleteFileUpload(i)" class="btn btn-secondary">X</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>




    <!-- Model Upload file -->
    <ng-template #Upload>
        <form [formGroup]="formUpload" (ngSubmit)="onSubmit()">
            <div class="modal-header no-boder-bottom">
                <div class="col-md-10 offset-md-1 text-center">
                    <h4 class="modal-title text-title text-model">Upload file phân công tiến độ</h4>
                </div>
                <div class="col-md-1">
                    <button type="button" class="close pull-right" aria-label="Close" (click)="modelUp.hide()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            </div>
            <div class="modal-body fg-w">
                <div class="row pd-up">
                    <div class="col-md-4 mg-l">Chọn file</div>
                    <div class="col-md-7 input-group">
                        <div class="custom-file form-control">
                            <input type="file" class="custom-file-input" id="inputGroupFile01">
                            <label class="custom-file-label" for="inputGroupFile01">--Choose file--</label>
                        </div>
                        <span class="input-group-addon">
                            <i class="fa fa-upload" aria-hidden="true"></i>
                        </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mg-l or">OR</div>
                </div>
                <div class="row pd-up">
                    <div class="col-md-4 mg-l">Đường dẫn file</div>
                    <div class="col-md-7">
                        <input type="text" class="form-control" placeholder="Text">
                    </div>
                </div>
                <div class="row pd-up">
                    <div class="col-md-4 mg-l">Tên</div>
                    <div class="col-md-7">
                        <input type="text" class="form-control" placeholder="Tên" formControlName="name" [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                        <div *ngIf="submitted && f.name.errors" class="invalid-feedback">
                            <div *ngIf="f.name.errors.required">Vui lòng nhập tên file</div>
                        </div>
                    </div>

                </div>

                <div class="row pd-up">
                    <div class="col-md-4 mg-l">Version</div>
                    <div class="col-md-7">
                        <input type="text" class="form-control" value="1">
                    </div>
                </div>

                <div class="row pd-up">
                    <div class="col-md-4 mg-l">Ngày Upload</div>
                    <div class="col-md-7 input-group">
                        <!-- <owl-date-time   [placeHolder]="datePickerConfig.placeHolderVn">
          </owl-date-time>
          <span class="input-group-addon">
            <i class="fa fa-calendar"></i>
          </span> -->
                        <input [placeholder]="datePickerConfig.datePlaceHolder" class="input-date-time input-date-time-bar"
                            readonly [owlDateTimeTrigger]="dt" [owlDateTime]="dt">
                        <owl-date-time #dt pickerType="calendar"></owl-date-time>
                        <span [owlDateTimeTrigger]="dt" class="input-group-addon">
                            <i class="fa fa-calendar"></i>
                        </span>
                    </div>
                </div>

                <div class="row pd-up">
                    <div class="col-md-4 mg-l">Mô tả/Nội dung cập nhật</div>
                    <div class="col-md-7">
                        <textarea class="form-control textarea-content" name="" id="" cols="30" rows="3" placeholder=""></textarea>
                    </div>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-default-w" [disabled]="loading">Upload</button>
                    <button type="button" class="btn btn-cancel btn-default-w" (click)="modelUp.hide()">Hủy</button>
                </div>
            </div>
        </form>
    </ng-template>

    <!-- Gửi phân công tiến độ -->
    <ng-template #SendAssignment>
        <div class="modal-header no-boder-bottom">
            <div class="col-md-10 offset-md-1 text-center">
                <h4 class="modal-title text-title text-model">{{textConfirmProgress}}</h4>
            </div>
            <div class="col-md-1">
                <button type="button" class="close pull-right" aria-label="Close" (click)="modelSendAssignment.hide()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
        <div class="modal-body">
            <p class="text-body">Bảng phân công tiến độ sẽ được gửi đến</p>
            <div class="">
                <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table-selection stripe row-border hover cell-border dataTable">
                    <thead>
                        <tr>
                            <th class="stt" style="width: 5%; min-width: 20px;background-color: #f68e56!important;">
                                <div class="d-flex justify-content-around">
                                    <div style="width: 40%;">
                                        <div class="center-parent">
                                            <label class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" [checked]="checked"
                                                    [(ngModel)]="checkboxSeclectAll" (change)="onSelectAll($event.target.checked)">
                                                <span class="custom-control-indicator"></span>
                                            </label>
                                        </div>
                                    </div>

                                    <div style="width: 35%;" class="center-parent">
                                        <div>STT</div>
                                    </div>
                                </div>
                            </th>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex">
                                    <div class="center-parent">
                                        <div>Phòng ban</div>
                                    </div>
                                </div>
                            </th>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex">
                                    <div class="center-parent">
                                        <div>Nhân viên</div>
                                    </div>
                                </div>
                            </th>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex">
                                    <div class="center-parent">
                                        <div>Email</div>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of listData; let i = index">
                            <td class="stt" style="width: 5%; min-width: 20px;">
                                <div class="d-flex justify-content-around">
                                    <div style="width: 40%;">
                                        <div class="center-parent">
                                            <label class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" [checked]="data.checkboxSelected"
                                                    [(ngModel)]="data.checkboxSelected">
                                                <span class="custom-control-indicator"></span>
                                            </label>
                                        </div>
                                    </div>

                                    <div style="width: 35%;" class="center-parent">
                                        <div>{{i+1}}</div>
                                    </div>
                                </div>
                            </td>
                            <td class="select-filter">{{ data.rom}}</td>
                            <td class="select-filter">{{ data.username}}</td>
                            <td class="select-filter color-default">{{ data.email}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="row pdOther">
                <div class="col-md-1">Khác</div>
                <div class="col">
                    <button type="button" class="btn btnOther">
                        <i class="fa fa-plus" aria-hidden="true"></i>
                    </button>
                </div>
            </div>

            <div class="main-table">
                <div class="d-flex flex-row flex-wrap filter-bar custom-filter-bar">
                    <div class="d-flex form-inline flex-pad">

                        <div class="form-group ml-sm-2">
                            <label for="" class="form-label">Phòng ban</label>
                            <span class="custom-dropdown mx-sm-2">
                                <select class="form-control">
                                    <option value="">--Tất cả--</option>
                                    <option *ngFor="let item of roms" [value]="item.id">{{item.name | translate}}</option>
                                </select>
                            </span>
                        </div>

                        <div class="form-group ml-sm-2">
                            <label for="" class="form-label">Nhân viên</label>
                            <span class="custom-dropdown mx-sm-2">
                                <select class="form-control">
                                    <option value="">--Lựa chọn--</option>
                                    <option *ngFor="let item of listUsers" [value]="item.id">{{item.name | translate}}</option>
                                </select>
                            </span>
                        </div>

                    </div>
                </div>
            </div>
            <div class="text-center">
                <button type="submit" class="btn btn-primary btn-default-w" (click)="sendConfirmAssignment()">Gửi phân
                    công
                </button>
                <button type="button" class="btn btn-cancel btn-default-w" (click)="modelSendAssignment.hide()">Hủy</button>
            </div>
        </div>
    </ng-template>

    <!-- ViewListData -->
    <ng-template #ViewListData>
        <div class="modal-header no-boder-bottom" style="margin-top: 0px">
            <div class="col-md-10 offset-md-1 text-center">
                <h4 class="modal-title text-model">Danh sách gửi phân công tiến độ</h4>
            </div>
            <div class="col-md-1">
                <button type="button" class="close pull-right" aria-label="Close" (click)="modalViewListData.hide()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
        <div class="modal-body">
            <div class="bot-table">
                <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table-selection stripe row-border hover cell-border dataTable">
                    <thead>
                        <tr>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex justify-content-center">
                                    <div class="center-parent">
                                        <div>STT</div>
                                    </div>
                                </div>
                            </th>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex">
                                    <div class="center-parent">
                                        <div>Phòng ban</div>
                                    </div>
                                </div>
                            </th>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex">
                                    <div class="center-parent">
                                        <div>Nhân viên</div>
                                    </div>
                                </div>
                            </th>
                            <th class="bg-default" style="background-color: #f68e56!important;">
                                <div class="d-flex">
                                    <div class="center-parent">
                                        <div>Email</div>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of listData; let i = index">
                            <td class="select-filter text-center">{{ i+1}}</td>
                            <td class="select-filter">{{ data.rom}}</td>
                            <td class="select-filter">{{ data.username}}</td>
                            <td class="select-filter color-default">{{ data.email}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>
    </ng-template>
    <!-- <ngx-spinner bdColor="rgba(51, 51, 51, 0.7)" size="default" color="#fff" type="ball-scale"></ngx-spinner> -->

</div>


<app-change-history-popup [updateInfo]="dataChangeHistory" [index]="index" *ngIf="showPopupDetail" (closed)="closePopupDetail($event)"></app-change-history-popup>

<ngx-loading [show]="loading"></ngx-loading>
